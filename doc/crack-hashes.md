## Discover (i.e. crack) the passwords with Hashcat

This procedure uses the password-cracking program Hashcat (NOTE:  The Hashcat program and related documentation can be found at https://hashcat.net/hashcat/) to test the password strength for accounts in Active Directory.  There are plenty of other tools to perform the cracking step, such as [John the Ripper](http://www.openwall.com/john/), but I like hashcat for both the community, and I think that the tool's various attack methods really lend themselves to understanding your users' passwords.

The actual analysis is performed through a couple methods.  Step one is to brute force the entire keyspace for all possible password combinations of length 1 through 8.  Even if a company's password creation settings disallow the use of shorter passwords, it is possible for them to exist in the directory due to legacy accounts or administrator override.

Because of the nine character minimum, no passwords are expected to be discovered in this step, however it is possible that a password could have been manually set at a shorter length by an administrator, so we want to test for this.

Beyond eight characters, it becomes computationally infeasible to brute-force the keyspace and complete our analysis in a reasonable time window.  Using a p3.16xlarge instance in AWS, it would take approximately one month, so we use different password analysis techniques.  First, we perform a dictionary attack with commonly used passwords as discovered from public account breaches, commonly used company passwords, and previously discovered passwords.  Next, we perform a hybrid attack in which we take a dictionary of words, apply a mask to the beginning and/or end of the word and also toggle characters to commonly used substitutes.  An example would be the word, ‘password’ becomes ‘P@$$word2018’.  Finally, we perform a straight mask analysis in we brute force common patterns used by people in constructing passwords.  For example, we would check all possible combinations of words that begin with a capital letter, followed by five lower case letters, and ending in four digits.

The last two techniques describe exhibit the real benefit of this approach to forced password changes.  In both these examples, we will discover all passwords that are incredibly weak and easy to guess yet fall within the confines of a more traditional password policy and would thus have been allowed to remain in the system, introducing additional risk to the company and its information assets.
